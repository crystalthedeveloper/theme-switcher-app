(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[564],{1149:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/select-site",function(){return n(6474)}])},6474:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var s=n(5893),a=n(7294),c=n(1163);function i(){let[e,t]=(0,a.useState)([]),[n,i]=(0,a.useState)([]),[o,r]=(0,a.useState)(""),[l,h]=(0,a.useState)(""),[u,d]=(0,a.useState)(""),[p,f]=(0,a.useState)(!1),[j,g]=(0,a.useState)(!1),x=(0,c.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("wf_token");e&&(d(e),f(!0),fetch("https://api.webflow.com/v1/sites",{headers:{Authorization:"Bearer ".concat(e)}}).then(e=>e.json()).then(e=>t(e)).catch(e=>console.error("Failed to fetch sites:",e)).finally(()=>f(!1)))},[]);let _=async()=>{try{await fetch("https://api.webflow.com/v1/sites/".concat(o,"/pages/").concat(l,"/custom-code"),{method:"PUT",headers:{Authorization:"Bearer ".concat(u),"Content-Type":"application/json"},body:JSON.stringify({head:"",body:'<script src="https://cdn.jsdelivr.net/gh/crystalthedeveloper/theme-switcher/theme-switcher.js" defer></script>',enabled:!0})}),x.push("/success")}catch(e){console.error("Injection failed:",e),alert("Failed to inject script. Please try again.")}};return(0,s.jsxs)("main",{style:{textAlign:"center",marginTop:"4rem"},children:[(0,s.jsx)("h2",{children:"Select Your Site & Page"}),p?(0,s.jsx)("p",{children:"Loading sites..."}):(0,s.jsxs)("select",{onChange:e=>{let t=e.target.value;r(t),g(!0),fetch("https://api.webflow.com/v1/sites/".concat(t,"/pages"),{headers:{Authorization:"Bearer ".concat(u)}}).then(e=>e.json()).then(e=>i(e)).catch(e=>console.error("Failed to fetch pages:",e)).finally(()=>g(!1))},value:o,children:[(0,s.jsx)("option",{value:"",children:"Select Site"}),e.map(e=>(0,s.jsx)("option",{value:e._id,children:e.name},e._id))]}),j&&(0,s.jsx)("p",{children:"Loading pages..."}),n.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)("select",{onChange:e=>h(e.target.value),value:l,children:[(0,s.jsx)("option",{value:"",children:"Select Page"}),n.map(e=>(0,s.jsx)("option",{value:e._id,children:e.name},e._id))]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:_,disabled:!l,children:"Inject Script"})]})]})}},1163:function(e,t,n){e.exports=n(6885)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1149)}),_N_E=e.O()}]);